#!/bin/bash

set -e

# Detect the package manager
if command -v dnf >/dev/null 2>&1; then
    echo "üì¶ DNF-based system detected (Fedora, RHEL, Rocky, CentOS)..."

    # For DNF-based systems (Fedora, RHEL, Rocky, CentOS)
    echo "üîÑ Adding Google Chrome repository for DNF-based systems..."
    sudo tee /etc/yum.repos.d/google-chrome.repo > /dev/null <<EOF
[google-chrome]
name=Google Chrome
baseurl=https://dl.google.com/linux/chrome/rpm/stable/x86_64
enabled=1
gpgcheck=1
gpgkey=https://dl-ssl.google.com/linux/linux_signing_key.pub
EOF

    echo "üîÑ Installing Google Chrome using DNF..."
    sudo dnf upgrade -y
    sudo dnf install -y google-chrome-stable
elif command -v apt >/dev/null 2>&1; then
    echo "üì¶ APT-based system detected (Ubuntu, Debian)..."

    echo "üîÑ Adding Google Chrome repository for APT-based systems..."
    wget -qO- https://dl.google.com/linux/linux_signing_key.pub | gpg --dearmor | sudo tee /etc/apt/trusted.gpg.d/google-linux-signing-keyring.gpg > /dev/null
    echo "deb [arch=amd64 signed-by=/etc/apt/trusted.gpg.d/google-linux-signing-keyring.gpg] http://dl.google.com/linux/chrome/deb/ stable main" | sudo tee /etc/apt/sources.list.d/google-chrome.list > /dev/null

    echo "üîÑ Installing Google Chrome using APT..."
    sudo apt update
    sudo apt install -y google-chrome-stable
else
    echo "‚ùå Neither dnf nor apt found. Unsupported system."
    exit 1
fi

if command -v google-chrome > /dev/null 2>&1; then
    echo "‚úÖ Google Chrome has been successfully installed."
else
    echo "‚ùå There was an error installing Google Chrome."
    exit 1
fi
